<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CMA FOUNDATION | SQUAD INTEL PRO</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --p1-red: #ff0000; --p2-orange: #ff8c00; --p3-cyan: #00ffff; --p4-purple: #9d50bb;
            --section-yellow: #ffff00; --ch-green: #39ff14; --topic-white: #ffffff;
            --bg-dark: #050505; --card-bg: rgba(15, 15, 20, 0.95);
        }
        * { box-sizing: border-box; transition: 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-dark); color: var(--topic-white); font-family: 'Rajdhani', sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        #login-screen { position: fixed; inset: 0; z-index: 1000; display: flex; justify-content: center; align-items: center; background: radial-gradient(circle, #1a0000 0%, #000 100%); }
        .auth-card { background: var(--card-bg); padding: 30px; border: 1px solid var(--p1-red); border-radius: 20px; text-align: center; width: 90%; max-width: 400px; box-shadow: 0 0 30px rgba(255, 0, 0, 0.2); }
        
        /* Logo Styles */
        .logo-box { position: relative; width: 100px; height: 100px; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; }
        .logo-img { width: 100%; height: 100%; object-fit: contain; animation: breathing 3s ease-in-out infinite; }
        .sidebar-logo-container { text-align: center; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05); margin-bottom: 15px; }
        .sidebar-logo { width: 45px; height: 45px; border-radius: 50%; animation: orbitGlow 4s ease-in-out infinite; filter: drop-shadow(0 0 5px var(--p3-cyan)); }

        /* Loading Screen */
        #loading-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 9999; display: none; flex-direction: column; justify-content: center; align-items: center; backdrop-filter: blur(10px); }
        .loader-logo { width: 80px; height: 80px; animation: breathing 1.5s infinite; }

        @keyframes breathing { 0%, 100% { transform: scale(1); filter: drop-shadow(0 0 5px var(--p1-red)); } 50% { transform: scale(1.05); filter: drop-shadow(0 0 15px var(--p1-red)); } }
        @keyframes orbitGlow { 0%, 100% { filter: drop-shadow(0 0 5px var(--p3-cyan)); border-color: var(--p3-cyan); } 50% { filter: drop-shadow(0 0 12px var(--ch-green)); border-color: var(--ch-green); } }

        .pass-input-wrapper { position: relative; display: flex; align-items: center; border-bottom: 2px solid var(--p1-red); margin-top: 20px; }
        input[type="password"] { background: transparent; border: none; color: var(--p1-red); font-family: 'Orbitron'; font-size: 1.2rem; padding: 10px; width: 100%; text-align: center; outline: none; }
        .login-arrow { background: none; border: none; color: var(--p1-red); font-size: 1.5rem; cursor: pointer; padding: 0 10px; display: flex; align-items: center; justify-content: center; transition: 0.2s; }
        .login-arrow:hover { transform: translateX(5px); text-shadow: 0 0 10px var(--p1-red); }

        #main-terminal { display: none; flex: 1; grid-template-columns: 1fr; overflow: hidden; }
        @media (min-width: 768px) { #main-terminal { grid-template-columns: 280px 1fr; } }

        .sidebar { background: #0a0a0c; border-right: 1px solid rgba(255,255,255,0.05); padding: 20px; display: flex; flex-direction: column; overflow-y: auto; }
        @media (max-width: 767px) { 
            .sidebar { height: auto; border-right: none; border-bottom: 1px solid #333; padding: 15px; } 
            .sidebar-logo-container { display: none; } 
            #main-terminal { grid-template-rows: auto 1fr; } 
            .nav-container { display: flex; overflow-x: auto; gap: 10px; padding-bottom: 5px; scrollbar-width: none; } 
            .nav-link { min-width: 140px; margin-bottom: 0 !important; font-size: 0.7rem !important; } 
        }

        .nav-link { padding: 12px; margin-bottom: 8px; border-radius: 8px; cursor: pointer; font-family: 'Orbitron'; font-size: 0.8rem; border-left: 4px solid transparent; opacity: 0.6; }
        .nav-link.active { border-left-color: var(--p3-cyan); background: rgba(0, 255, 255, 0.1); opacity: 1; }
        .content { overflow-y: auto; padding: 20px 20px 100px 20px; flex: 1; position: relative; }
        
        .chart-container { background: rgba(255,255,255,0.02); border: 1px solid #222; border-radius: 15px; padding: 20px; margin-bottom: 30px; position: relative; height: 250px; display: flex; align-items: flex-end; justify-content: space-around; }
        .y-axis { position: absolute; left: 10px; height: 75%; border-left: 1px solid #444; display: flex; flex-direction: column; justify-content: space-between; font-size: 0.6rem; color: #666; padding-left: 5px; }
        .bar-wrapper { display: flex; flex-direction: column; align-items: center; width: 25%; position: relative; z-index: 5; }
        .bar-pillar { width: 30px; background: linear-gradient(0deg, #111 0%, var(--ch-green) 100%); border-radius: 4px 4px 0 0; min-height: 2px; transition: height 1s ease; }
        .bar-val { font-family: 'Orbitron'; font-size: 0.7rem; margin-bottom: 5px; color: var(--ch-green); }
        .bar-label { font-family: 'Orbitron'; font-size: 0.6rem; margin-top: 10px; color: #888; text-align: center; }

        .pie-scroll-container { display: flex; overflow-x: auto; gap: 20px; padding: 20px 0; scrollbar-width: none; margin-bottom: 30px; border-bottom: 1px solid #222; }
        .pie-card { flex: 0 0 auto; display: flex; flex-direction: column; align-items: center; width: 120px; }
        .multi-pie { width: 80px; height: 80px; border-radius: 50%; position: relative; display: flex; align-items: center; justify-content: center; }
        .multi-pie::after { content: ""; position: absolute; width: 60px; height: 60px; background: #050505; border-radius: 50%; z-index: 2; }
        .pie-val { position: relative; z-index: 3; font-family: 'Orbitron'; font-size: 0.8rem; color: #fff; }
        .pie-label { font-size: 0.7rem; margin-top: 10px; font-family: 'Orbitron'; opacity: 0.7; }

        .comp-item { background: rgba(255,255,255,0.02); padding: 12px; border-radius: 8px; border-left: 4px solid transparent; margin-bottom: 8px; }
        .comp-label { font-size: 0.6rem; font-family: 'Orbitron'; opacity: 0.5; margin-bottom: 4px; }
        .comp-bar-bg { height: 6px; background: #222; border-radius: 3px; overflow: hidden; }

        .rank-card { background: #111; padding: 15px; border-radius: 12px; margin-bottom: 12px; cursor: pointer; border: 1px solid #222; }
        .detail-view { display: none; flex-direction: column; padding: 10px; background: rgba(0,0,0,0.4); border-radius: 8px; margin-top: 10px; }
        
        .ch-card { background: rgba(255,255,255,0.02); border: 1px solid var(--ch-green); margin-bottom: 15px; border-radius: 10px; overflow: hidden; }
        .ch-head { padding: 12px 15px; background: rgba(57, 255, 20, 0.05); color: var(--ch-green); font-family: 'Orbitron'; font-size: 0.85rem; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        .topic-row { padding: 10px 15px; display: flex; align-items: center; border-bottom: 1px solid #222; font-size: 0.9rem; }
        input[type="checkbox"] { width: 22px; height: 22px; margin-right: 15px; accent-color: var(--p3-cyan); flex-shrink: 0; cursor: pointer; }

        .upload-btn { background: var(--p3-cyan); color: #000; padding: 4px 8px; border-radius: 4px; font-size: 0.6rem; font-family: 'Orbitron'; cursor: pointer; font-weight: bold; border: none; }
        .lock-btn-fixed { background: rgba(255, 0, 0, 0.2); color: var(--p1-red); padding: 4px 8px; border-radius: 4px; font-size: 0.7rem; font-family: 'Orbitron'; border: 1px solid var(--p1-red); cursor: pointer; display: flex; align-items: center; gap: 5px; }

        /* Unified Footer Fix */
        .footer { 
            background: rgba(0, 0, 0, 0.95); 
            border-top: 1px solid rgba(255, 255, 255, 0.1); 
            padding: 15px 10px; 
            text-align: center; 
            font-family: 'Orbitron', sans-serif !important; 
            font-size: 0.65rem; 
            color: rgba(255, 255, 255, 0.5); 
            width: 100%; 
            flex-shrink: 0;
            position: relative;
            z-index: 10;
        }
        .footer span { color: var(--p3-cyan); text-shadow: 0 0 5px var(--p3-cyan); }

        .node-card { background: rgba(255,255,255,0.02); border: 1px solid #222; padding: 15px; border-radius: 10px; margin-bottom: 10px; position: relative; overflow: hidden; }
        .node-hash { font-family: 'Orbitron'; font-size: 0.5rem; color: #444; margin-top: 5px; word-break: break-all; }
        .node-status { float: right; font-family: 'Orbitron'; font-size: 0.6rem; padding: 2px 8px; border-radius: 4px; }
        .lock-container { display: flex; flex-direction: column; align-items: center; justify-content: center; background: rgba(255, 0, 0, 0.05); border: 1px dashed var(--p1-red); border-radius: 15px; padding: 40px 20px; text-align: center; margin-bottom: 20px; }
    </style>
</head>
<body>
    <div id="loading-overlay">
        <img src="assets/server-icon.png" class="loader-logo" alt="Loading">
    </div>

    <div id="login-screen">
        <div class="auth-card">
            <div class="logo-box"><img src="assets/server-icon.png" alt="SQUAD" class="logo-img"></div>
            <h1 style="color:var(--p1-red); font-family:'Orbitron'; font-size: 1.2rem;">IDENTITY CHECK</h1>
            <div class="pass-input-wrapper">
                <input type="password" id="passCode" placeholder="ACCESS KEY..." onkeydown="if(event.key==='Enter') verify()">
                <button class="login-arrow" onclick="verify()">âžœ</button>
            </div>
        </div>
    </div>

    <div id="main-terminal">
        <aside class="sidebar">
            <div class="sidebar-logo-container">
                <img src="assets/server-icon.png" class="sidebar-logo" alt="logo">
                <div id="agent-name" style="font-family:'Orbitron'; color:var(--ch-green); font-size: 1rem;">---</div>
                <div id="overall-prog" style="color:var(--p3-cyan); font-size:0.75rem; margin-top:5px; font-family:'Orbitron';">MISSION: 0%</div>
            </div>
            <nav id="sidebar-nav" class="nav-container">
                <div class="nav-link active" onclick="showView('home', this)">SQUAD HUB</div>
                <div class="nav-link" onclick="showView('attendance', this)">ATTDENCE LAGAO</div>
                <div class="nav-link" onclick="showView('p1', this)">P1: LAWS</div>
                <div class="nav-link" onclick="showView('p2', this)">P2: ACCOUNTS</div>
                <div class="nav-link" onclick="showView('p3', this)">P3: MATH</div>
                <div class="nav-link" onclick="showView('p4', this)">P4: ECON</div>
            </nav>
            <button onclick="location.reload()" style="margin-top:auto; background:none; border:1px solid #444; color:#666; padding:8px; border-radius:5px; cursor:pointer; font-size: 0.7rem; font-family:'Orbitron';">LOGOUT</button>
        </aside>
        <main class="content" id="viewport"></main>
    </div>

    <footer class="footer">ALL RIGHTS ARE PRIVATE <span>Â© NOTZIE 2026</span></footer>

    <script>
        const API_URL = "https://sheetdb.io/api/v1/oj0l2zb1m9qnd";
        const DRIVE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwB1dGM26Vsxo9hYoqZPyRJZ_7QY4fPOm4b-qrZKLfMT3QEoDVEmpbySlQMueOyGICqzw/exec";
        const AGENTS = { "rajyash": "Yash Raj", "singhtanay": "Tanay Singh", "murmuprem": "Prem Murmu" };
        const SYLLABUS = {
            p1: { title: "Paper 1", subName: "BUSINESS LAWS & COMMUNICATION", color: "var(--p1-red)", sections: [{ name: "SECTION A: BUSINESS LAWS", chapters: [{ name: "Introduction to Law", topics: ["Sources of Law", "Legislative Process", "Court System"] }, { name: "Indian Contract Act, 1872", topics: ["Offer & Acceptance", "Consideration", "Capacity", "Consent", "Breach"] }, { name: "Sale of Goods Act, 1930", topics: ["Formation", "Ownership", "Unpaid Seller"] }, { name: "Negotiable Instruments", topics: ["Types", "Sec 138"] }]}, { name: "SECTION B: COMMUNICATION", chapters: [{ name: "Comm Skills", topics: ["Principles", "Barriers", "Correspondence"] }]}]},
            p2: { title: "Paper 2", subName: "FINANCIAL & COST ACCOUNTING", color: "var(--p2-orange)", sections: [{ name: "SECTION A: FINANCIAL ACCOUNTS", chapters: [{ name: "Fundamentals", topics: ["GAAP", "Journal", "BRS", "Depreciation"] }, { name: "Special Transactions", topics: ["Consignment", "Joint Venture", "Bills"] }, { name: "Final Accounts", topics: ["Sole Prop", "NPO"] }]}, { name: "SECTION B: COST ACCOUNTS", chapters: [{ name: "Costing Basics", topics: ["Classification", "Cost Sheet"] }]}]},
            p3: { title: "Paper 3", subName: "MATH & STATISTICS", color: "var(--p3-cyan)", sections: [{ name: "SECTION A: MATHEMATICS", chapters: [{ name: "Arithmetic", topics: ["Ratio", "Interest", "Progression"] }, { name: "Algebra", topics: ["Sets", "Permutations", "Quadratic"] }, { name: "Calculus", topics: ["Derivatives"] }]}, { name: "SECTION B: STATISTICS", chapters: [{ name: "Representation", topics: ["Diagrams", "Central Tendency", "Dispersion"] }, { name: "Advanced", topics: ["Correlation", "Probability", "Time Series"] }]}]},
            p4: { title: "Paper 4", subName: "ECONOMICS & MANAGEMENT", color: "var(--p4-purple)", sections: [{ name: "SECTION A: ECONOMICS", chapters: [{ name: "Concepts", topics: ["Demand/Supply", "Production", "Cost"] }, { name: "Market/Banking", topics: ["Monopoly", "Money Functions", "PESTEL"] }]}, { name: "SECTION B: MANAGEMENT", chapters: [{ name: "Process", topics: ["Planning", "Leading", "Decision Making", "Motivation"] }]}]}
        };

        let activeAgent = "", db = { "Tanay Singh": {}, "Prem Murmu": {}, "Yash Raj": {} }, countdownTimer;

        function showLoading() { document.getElementById('loading-overlay').style.display = 'flex'; }
        function hideLoading() { document.getElementById('loading-overlay').style.display = 'none'; }

        async function verify() {
            const val = document.getElementById('passCode').value;
            if (AGENTS[val]) { activeAgent = AGENTS[val]; await fetchCloudData(); document.getElementById('login-screen').style.display = 'none'; document.getElementById('main-terminal').style.display = 'grid'; document.getElementById('agent-name').innerText = activeAgent; showView('home', document.querySelector('.nav-link')); }
        }

        async function fetchCloudData() {
            try { const res = await fetch(API_URL); const data = await res.json(); data.forEach(row => { if (row.progress_data) db[row.agent_name] = JSON.parse(row.progress_data); }); } catch (e) {}
        }

        async function toggleTopic(key, paperKey, chName) {
            db[activeAgent][key] = !db[activeAgent][key];
            document.getElementById('overall-prog').innerText = "MISSION: " + getOverall(activeAgent) + "%";
            await fetch(`${API_URL}/agent_name/${activeAgent}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ "progress_data": JSON.stringify(db[activeAgent]) }) });
            showView(paperKey);
        }

        async function unlockChapter(pk, chName) {
            if(confirm(`MANUALLY UNLOCK ${chName}? ALL DRIVE FILES WILL BE DELETED.`)) {
                showLoading();
                await fetch(DRIVE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ agent: activeAgent, paper: SYLLABUS[pk].title, chapter: chName, action: "DELETE" }) });
                delete db[activeAgent][pk + chName + "_archived"];
                await fetch(`${API_URL}/agent_name/${activeAgent}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ "progress_data": JSON.stringify(db[activeAgent]) }) });
                showView(pk);
                setTimeout(hideLoading, 500);
            }
        }

        async function archiveChapter(pk, chName) {
            const input = document.createElement('input'); input.type = 'file'; input.multiple = true; input.accept = 'image/*';
            input.onchange = async (e) => {
                showLoading();
                const files = Array.from(e.target.files);
                const fileData = await Promise.all(files.map(file => new Promise(res => { const r = new FileReader(); r.onload = ev => res({ data: ev.target.result.split(',')[1], type: file.type }); r.readAsDataURL(file); })));
                await fetch(DRIVE_SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify({ agent: activeAgent, paper: SYLLABUS[pk].title, chapter: chName, files: fileData, action: "UPLOAD" }) });
                db[activeAgent][pk + chName + "_archived"] = true;
                await fetch(`${API_URL}/agent_name/${activeAgent}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ "progress_data": JSON.stringify(db[activeAgent]) }) });
                showView(pk);
                hideLoading();
            };
            input.click();
        }

        async function markAttendance() {
            const studyDay = getStudyDay();
            if(db[activeAgent].logs?.includes(studyDay)) return alert("ALREADY LOGGED.");
            if(!db[activeAgent].logs) db[activeAgent].logs = [];
            db[activeAgent].logs.push(studyDay);
            await fetch(`${API_URL}/agent_name/${activeAgent}`, { method: 'PATCH', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ "progress_data": JSON.stringify(db[activeAgent]) }) });
            showView('attendance');
        }

        function getStudyDay() { const now = new Date(); if (now.getHours() < 4) now.setDate(now.getDate() - 1); return now.toLocaleDateString('en-GB'); }
        function updateCountdown() {
            const el = document.getElementById('reset-timer'); if (!el) return;
            const now = new Date(); const launchDate = new Date(2026, 3, 1, 4, 0, 0); 
            if (now < launchDate) {
                const diff = launchDate - now, d = Math.floor(diff / 86400000), h = Math.floor((diff % 86400000) / 3600000), m = Math.floor((diff % 3600000) / 60000), s = Math.floor((diff % 60000) / 1000);
                el.innerText = `OPENING IN: ${d}D ${h}H ${m}M ${s}S`; return;
            }
            let target = new Date(); target.setHours(4, 0, 0, 0); if (now.getHours() >= 4) target.setDate(target.getDate() + 1);
            const diff = target - now, h = Math.floor(diff / 3600000), m = Math.floor((diff % 3600000) / 60000), s = Math.floor((diff % 60000) / 1000);
            el.innerText = `RESET IN: ${h}H ${m}M ${s}S`;
        }

        function getChProgress(name, pk, chName) {
            let t = 0, d = 0; SYLLABUS[pk].sections.forEach(s => s.chapters.filter(c => c.name === chName).forEach(c => c.topics.forEach(tp => { t++; if (db[name][pk+c.name+tp]) d++; })));
            return Math.round((d/t)*100) || 0;
        }
        function getProgress(name, pk) {
            let t = 0, d = 0; SYLLABUS[pk].sections.forEach(s => s.chapters.forEach(c => c.topics.forEach(tp => { t++; if (db[name][pk+c.name+tp]) d++; })));
            return (d/t)*100 || 0;
        }
        function getOverall(n) { return Math.round((['p1','p2','p3','p4'].reduce((a,p) => a + getProgress(n,p), 0))/4); }

        function showView(vid, el) {
            clearInterval(countdownTimer);
            const vp = document.getElementById('viewport'); vp.innerHTML = "";
            if (el) { document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active')); el.classList.add('active'); }
            
            if (vid === 'home') {
                vp.innerHTML = `<h2 style="color:var(--p3-cyan); font-family:'Orbitron'; font-size:1.1rem; margin-bottom:20px">SQUAD ANALYTICS</h2>`;
                let chartHTML = `<div class="chart-container"><div class="y-axis"><span>100%</span><span>50%</span><span>0%</span></div>`;
                Object.values(AGENTS).forEach(name => {
                    const ov = getOverall(name);
                    chartHTML += `<div class="bar-wrapper"><span class="bar-val">${ov}%</span><div class="bar-pillar" style="height:${ov * 1.5}px"></div><span class="bar-label">${name.split(' ')[0]}</span></div>`;
                });
                chartHTML += `</div><div class="pie-scroll-container">`;
                Object.values(AGENTS).forEach(name => {
                    const ov = getOverall(name), p1 = getProgress(name,'p1'), p2 = getProgress(name,'p2'), p3 = getProgress(name,'p3'), p4 = getProgress(name,'p4');
                    chartHTML += `<div class="pie-card"><div class="multi-pie" style="background: conic-gradient(var(--p1-red) 0% ${p1*0.25}%, #222 ${p1*0.25}% 25%, var(--p2-orange) 25% ${25+p2*0.25}%, #222 ${25+p2*0.25}% 50%, var(--p3-cyan) 50% ${50+p3*0.25}%, #222 ${50+p3*0.25}% 75%, var(--p4-purple) 75% ${75+p4*0.25}%, #222 ${75+p4*0.25}% 100%)"><div class="pie-val">${ov}%</div></div><div class="pie-label">${name.split(' ')[0]}</div></div>`;
                });
                vp.innerHTML += chartHTML + `</div>`;
                Object.values(AGENTS).forEach(name => {
                    const ov = getOverall(name), safeId = name.replace(/\s/g, ''); let seqHTML = "";
                    Object.keys(SYLLABUS).forEach(pk => { SYLLABUS[pk].sections.forEach(s => s.chapters.forEach(ch => {
                        const chP = getChProgress(name, pk, ch.name);
                        seqHTML += `<div class="comp-item" style="border-left-color:${SYLLABUS[pk].color}"><div class="comp-label">${SYLLABUS[pk].title}</div><div style="display:flex; justify-content:space-between; font-size:0.75rem"><span>${ch.name}</span><span>${chP}%</span></div><div class="comp-bar-bg"><div style="height:100%; width:${chP}%; background:${SYLLABUS[pk].color}"></div></div></div>`;
                    }));});
                    vp.innerHTML += `<div class="rank-card" onclick="const d=document.getElementById('det-${safeId}'); d.style.display=(d.style.display==='flex'?'none':'flex')"><div style="display:flex; justify-content:space-between; font-family:'Orbitron'; font-size:0.8rem"><span>${name}</span><span style="color:var(--ch-green)">${ov}%</span></div><div class="detail-view" id="det-${safeId}">${seqHTML}</div></div>`;
                });
            } else if (vid === 'attendance') {
                const now = new Date(), launchDate = new Date(2026, 3, 1, 4, 0, 0), isLocked = now < launchDate, studyDay = getStudyDay();
                vp.innerHTML = `<h2 style="color:var(--p3-cyan); font-family:'Orbitron'; font-size:1.1rem; margin-bottom:20px">SQUAD ACTIVITY LOG</h2>`;
                if (isLocked) vp.innerHTML += `<div class="lock-container"><h3 style="color:var(--p1-red); font-family:'Orbitron';">VACATION TIME</h3><p id="reset-timer" style="font-size: 0.8rem; color:white;">---</p></div>`;
                else vp.innerHTML += `<div style="background:var(--card-bg); border:1px solid #333; padding:20px; border-radius:15px; margin-bottom:20px; text-align:center;"><p id="reset-timer" style="font-size: 0.75rem; color:var(--p2-orange); font-family:'Orbitron';">---</p><button onclick="markAttendance()" style="width:100%; padding:15px; background:var(--p3-cyan); border:none; border-radius:8px; font-family:'Orbitron'; font-weight:bold; cursor:pointer;">INITIALIZE DAILY SESSION</button></div>`;
                updateCountdown(); countdownTimer = setInterval(updateCountdown, 1000);
                Object.values(AGENTS).forEach(name => {
                    const logs = db[name].logs || [], act = logs.includes(studyDay);
                    vp.innerHTML += `<div class="node-card" style="border-left: 4px solid ${act?'var(--ch-green)':'#444'}"><span class="node-status" style="background:${act?'rgba(57,255,20,0.1)':'#111'}; color:${act?'var(--ch-green)':'#444'}">${act?'ONLINE':'OFFLINE'}</span><div style="font-family:'Orbitron'; font-size:0.9rem;">${name}</div><div style="font-size:0.75rem; color:#888;">STREAK: ${logs.length} DAYS</div></div>`;
                });
            } else {
                const data = SYLLABUS[vid]; 
                vp.innerHTML = `<h1 style="color:${data.color}; font-family:'Orbitron'; font-size:1.4rem; margin:0">${data.title}</h1><p style="color:#666; font-family:'Orbitron'; font-size:0.75rem;">${data.subName}</p>`;
                data.sections.forEach(sec => {
                    vp.innerHTML += `<div style="background:var(--section-yellow); color:#000; padding:8px 12px; margin:15px 0; font-family:'Orbitron'; border-radius:4px; font-size:0.75rem; font-weight:bold">${sec.name}</div>`;
                    sec.chapters.forEach(ch => {
                        const isDone = getChProgress(activeAgent, vid, ch.name) === 100, isLocked = db[activeAgent][vid + ch.name + "_archived"];
                        let h = `<div class="ch-card"><div class="ch-head"><span>${ch.name}</span>`;
                        if (isLocked) h += `<div class="lock-btn-fixed" onclick="unlockChapter('${vid}','${ch.name}')">LOCKED ðŸ”’</div>`;
                        else if (isDone) h += `<button class="upload-btn" onclick="archiveChapter('${vid}','${ch.name}')">ARCHIVE NOTES</button>`;
                        h += `</div><div class="topic-body">`;
                        ch.topics.forEach(t => { const k = vid+ch.name+t, c = db[activeAgent][k]?'checked':''; h += `<div class="topic-row"><input type="checkbox" onchange="toggleTopic('${k}', '${vid}', '${ch.name}')" ${c} ${isLocked?'disabled':''} style="accent-color:${data.color}"><span>${t}</span></div>`; });
                        vp.innerHTML += h + `</div></div>`;
                    });
                });
            }
        }
    </script>
</body>
</html>
